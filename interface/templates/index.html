<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BioExpace Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
</head>
<body class="bg-white-dashboard">

<div class="container-fluid py-3">
    <h1 class="dashboard-title mb-4">BioExpace</h1>

    <!-- Filters & Visualizations Row -->
    <div class="row mb-4 align-items-start">
        <div class="col-md-4 mb-2">
            <div class="card sidebar-card h-100">
                <div class="card-body">
                    <h5 class="sidebar-title">Search & Filter</h5>
                    <input type="text" id="keywordFilter" class="form-control" placeholder="Search documents..." oninput="filterDocuments()">
                </div>
            </div>
        </div>

        <div class="col-md-4 mb-2">
            <div class="card sidebar-card h-100">
                <div class="card-body">
                    <h5 class="sidebar-title">Word Cloud</h5>
                    <div id="wordCloud" style="height: 180px;"></div>
                </div>
            </div>
        </div>

        <div class="col-md-4 mb-2">
            <div class="card sidebar-card h-100">
                <div class="card-body">
                    <h5 class="sidebar-title">Theme Distribution</h5>
                    <div id="barChart" style="height: 180px;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Document List -->
    <div id="documentList" class="row">
        {% for doc in documents %}
        <div class="col-md-6 col-lg-4 mb-4 document-card">
            <div class="card doc-card h-100">
                <div class="card-body d-flex flex-column">
                    <h5 class="doc-title">{{ doc.title }}</h5>
                    <p class="doc-date"><small>{{ doc.date }}</small></p>

                    <!-- Themes & Insights -->
                    <div class="doc-insights mb-2">
                        {% for theme, details in doc.themes.items() %}
                        <span class="theme-tag" title="{{ theme }}">{{ theme }}</span>
                        <ul class="mb-1">
                            {% for point in details.points[:2] %}
                            <li>{{ point | truncate(60, True) }}</li>
                            {% endfor %}
                        </ul>
                        {% endfor %}
                    </div>

                    <!-- Explore Button -->
                    <a href="{{ url_for('document', doc_id=doc.id) }}" class="btn btn-purple mt-auto">Explore</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    <nav>
        <ul id="pagination" class="pagination justify-content-center mt-4"></ul>
    </nav>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script src="https://cdn.jsdelivr.net/npm/d3-cloud@1.2.5/build/d3.layout.cloud.js"></script>
<script src="{{ url_for('static', filename='js/index.js') }}"></script>
</body>
</html>
